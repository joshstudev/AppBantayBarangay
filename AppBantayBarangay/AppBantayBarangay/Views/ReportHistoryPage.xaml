<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AppBantayBarangay.Views.ReportHistoryPage"
             NavigationPage.HasNavigationBar="False"
             BackgroundColor="#F5F5F5">
    
    <ContentPage.Resources>
        <ResourceDictionary>
            <Color x:Key="PrimaryBlue">#2196F3</Color>
            <Color x:Key="AccentOrange">#FF9800</Color>
            <Color x:Key="AccentGreen">#4CAF50</Color>
            <Color x:Key="AccentRed">#F44336</Color>
            <Color x:Key="DarkGray">#333333</Color>
            <Color x:Key="MediumGray">#E0E0E0</Color>
        </ResourceDictionary>
    </ContentPage.Resources>
    
    <Grid RowDefinitions="Auto,*">
        
        <!-- Header (Matching LoginPage/RegisterPage Style) -->
        <Grid Grid.Row="0" BackgroundColor="{StaticResource PrimaryBlue}" Padding="20,10" HeightRequest="70">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            
            <!-- Logo (Same as LoginPage/RegisterPage) -->
            <Frame Grid.Column="0" 
                   HeightRequest="50" 
                   WidthRequest="50" 
                   CornerRadius="25" 
                   Padding="3" 
                   BackgroundColor="Transparent" 
                   BorderColor="Transparent"
                   VerticalOptions="Center" 
                   HorizontalOptions="Start"
                   HasShadow="False">
                <Image Source="logo" 
                       Aspect="AspectFit"
                       HorizontalOptions="Center" 
                       VerticalOptions="Center"/>
            </Frame>
            
            <StackLayout Grid.Column="1" 
                        VerticalOptions="Center" 
                        HorizontalOptions="Center">
                <Label Text="My Report History" 
                       TextColor="White" 
                       FontSize="22" 
                       FontAttributes="Bold"
                       HorizontalTextAlignment="Center"/>
                <Label Text="Track your submitted reports" 
                       TextColor="White" 
                       FontSize="14" 
                       HorizontalTextAlignment="Center"/>
            </StackLayout>

            <Button Grid.Column="2"
                    x:Name="BackButton"
                    Text="←"
                    BackgroundColor="Transparent"
                    TextColor="White"
                    FontSize="24"
                    HeightRequest="40"
                    WidthRequest="40"
                    CornerRadius="20"
                    Padding="0"
                    VerticalOptions="Center"
                    Clicked="BackButton_Clicked"/>
        </Grid>

        <!-- Main Content -->
        <ScrollView Grid.Row="1">
            <StackLayout Padding="15" Spacing="15">

                <!-- Statistics Cards -->
                <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="8" Margin="0,0,0,10">
                    <!-- Total -->
                    <Frame Grid.Column="0" 
                           BackgroundColor="White" 
                           CornerRadius="12" 
                           Padding="12" 
                           HasShadow="True">
                        <StackLayout Spacing="5">
                            <Label x:Name="TotalCountLabel" 
                                   Text="0" 
                                   FontSize="24" 
                                   FontAttributes="Bold" 
                                   TextColor="{StaticResource PrimaryBlue}" 
                                   HorizontalOptions="Center"/>
                            <Label Text="Total" 
                                   FontSize="11" 
                                   TextColor="{StaticResource DarkGray}" 
                                   HorizontalOptions="Center"/>
                        </StackLayout>
                    </Frame>
                    
                    <!-- Pending -->
                    <Frame Grid.Column="1" 
                           BackgroundColor="White" 
                           CornerRadius="12" 
                           Padding="12" 
                           HasShadow="True">
                        <StackLayout Spacing="5">
                            <Label x:Name="PendingCountLabel" 
                                   Text="0" 
                                   FontSize="24" 
                                   FontAttributes="Bold" 
                                   TextColor="{StaticResource AccentOrange}" 
                                   HorizontalOptions="Center"/>
                            <Label Text="Pending" 
                                   FontSize="11" 
                                   TextColor="{StaticResource DarkGray}" 
                                   HorizontalOptions="Center"/>
                        </StackLayout>
                    </Frame>
                    
                    <!-- In Progress -->
                    <Frame Grid.Column="2" 
                           BackgroundColor="White" 
                           CornerRadius="12" 
                           Padding="12" 
                           HasShadow="True">
                        <StackLayout Spacing="5">
                            <Label x:Name="InProgressCountLabel" 
                                   Text="0" 
                                   FontSize="24" 
                                   FontAttributes="Bold" 
                                   TextColor="{StaticResource PrimaryBlue}" 
                                   HorizontalOptions="Center"/>
                            <Label Text="Active" 
                                   FontSize="11" 
                                   TextColor="{StaticResource DarkGray}" 
                                   HorizontalOptions="Center"/>
                        </StackLayout>
                    </Frame>
                    
                    <!-- Resolved -->
                    <Frame Grid.Column="3" 
                           BackgroundColor="White" 
                           CornerRadius="12" 
                           Padding="12" 
                           HasShadow="True">
                        <StackLayout Spacing="5">
                            <Label x:Name="ResolvedCountLabel" 
                                   Text="0" 
                                   FontSize="24" 
                                   FontAttributes="Bold" 
                                   TextColor="{StaticResource AccentGreen}" 
                                   HorizontalOptions="Center"/>
                            <Label Text="Done" 
                                   FontSize="11" 
                                   TextColor="{StaticResource DarkGray}" 
                                   HorizontalOptions="Center"/>
                        </StackLayout>
                    </Frame>
                </Grid>

                <!-- Filter Buttons -->
                <ScrollView Orientation="Horizontal" HorizontalScrollBarVisibility="Never">
                    <StackLayout Orientation="Horizontal" Spacing="10">
                        <Button x:Name="AllButton" 
                                Text="All" 
                                Clicked="FilterButton_Clicked"
                                BackgroundColor="{StaticResource PrimaryBlue}" 
                                TextColor="White"
                                CornerRadius="20" 
                                Padding="20,10" 
                                FontSize="14"
                                FontAttributes="Bold"/>
                        <Button x:Name="PendingButton" 
                                Text="Pending" 
                                Clicked="FilterButton_Clicked"
                                BackgroundColor="{StaticResource MediumGray}" 
                                TextColor="{StaticResource DarkGray}"
                                CornerRadius="20" 
                                Padding="20,10" 
                                FontSize="14"/>
                        <Button x:Name="InProgressButton" 
                                Text="In Progress" 
                                Clicked="FilterButton_Clicked"
                                BackgroundColor="{StaticResource MediumGray}" 
                                TextColor="{StaticResource DarkGray}"
                                CornerRadius="20" 
                                Padding="20,10" 
                                FontSize="14"/>
                        <Button x:Name="ResolvedButton" 
                                Text="Resolved" 
                                Clicked="FilterButton_Clicked"
                                BackgroundColor="{StaticResource MediumGray}" 
                                TextColor="{StaticResource DarkGray}"
                                CornerRadius="20" 
                                Padding="20,10" 
                                FontSize="14"/>
                    </StackLayout>
                </ScrollView>

                <!-- Reports Container -->
                <StackLayout x:Name="ReportsContainer" Spacing="12"/>

                <!-- Empty State -->
                <StackLayout x:Name="EmptyStateContainer" 
                             IsVisible="False"
                             Padding="40"
                             VerticalOptions="CenterAndExpand">
                    <Label Text="📭"
                           FontSize="80"
                           HorizontalOptions="Center"
                           Margin="0,20,0,10"/>
                    <Label Text="No reports found"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="{StaticResource DarkGray}"
                           HorizontalOptions="Center"
                           Margin="0,0,0,5"/>
                    <Label Text="You haven't submitted any reports yet"
                           FontSize="14"
                           TextColor="{StaticResource DarkGray}"
                           HorizontalOptions="Center"
                           HorizontalTextAlignment="Center"
                           Opacity="0.7"/>
                </StackLayout>

            </StackLayout>
        </ScrollView>

        <!-- Report Details Modal -->
        <Frame x:Name="ReportDetailsModal"
               Grid.RowSpan="2"
               IsVisible="False"
               BackgroundColor="#CC000000"
               Padding="0"
               CornerRadius="0"
               HasShadow="False">
            <Frame BackgroundColor="White"
                   CornerRadius="20"
                   Padding="0"
                   Margin="20"
                   VerticalOptions="Center"
                   HasShadow="True">
                <ScrollView>
                    <StackLayout Padding="20" Spacing="15">
                        
                        <!-- Modal Header -->
                        <Grid>
                            <Label Text="Report Details"
                                   FontSize="22"
                                   FontAttributes="Bold"
                                   TextColor="{StaticResource PrimaryBlue}"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"/>
                            <Button x:Name="CloseModalButton"
                                    Text="✕"
                                    Clicked="CloseModal_Clicked"
                                    BackgroundColor="Transparent"
                                    TextColor="{StaticResource DarkGray}"
                                    FontSize="24"
                                    FontAttributes="Bold"
                                    HeightRequest="40"
                                    WidthRequest="40"
                                    CornerRadius="20"
                                    Padding="0"
                                    HorizontalOptions="End"/>
                        </Grid>

                        <BoxView HeightRequest="1" 
                                BackgroundColor="{StaticResource MediumGray}"/>

                        <!-- Report Image -->
                        <Frame BorderColor="{StaticResource MediumGray}" 
                               CornerRadius="10" 
                               Padding="0"
                               HasShadow="False">
                            <Image x:Name="ModalReportImage"
                                   HeightRequest="200"
                                   Aspect="AspectFill"/>
                        </Frame>

                        <!-- Report Info -->
                        <StackLayout Spacing="10">
                            <Label Text="Description" 
                                   FontSize="16" 
                                   FontAttributes="Bold"
                                   TextColor="{StaticResource PrimaryBlue}"/>
                            <Label x:Name="ModalDescription"
                                   FontSize="14"
                                   TextColor="{StaticResource DarkGray}"/>

                            <Label Text="Date Reported" 
                                   FontSize="16" 
                                   FontAttributes="Bold"
                                   TextColor="{StaticResource PrimaryBlue}"
                                   Margin="0,10,0,0"/>
                            <Label x:Name="ModalDateReported"
                                   FontSize="14"
                                   TextColor="{StaticResource DarkGray}"/>

                            <Label Text="Location" 
                                   FontSize="16" 
                                   FontAttributes="Bold"
                                   TextColor="{StaticResource PrimaryBlue}"
                                   Margin="0,10,0,0"/>
                            <Label x:Name="ModalLocation"
                                   FontSize="14"
                                   TextColor="{StaticResource DarkGray}"/>

                            <Label Text="Status" 
                                   FontSize="16" 
                                   FontAttributes="Bold"
                                   TextColor="{StaticResource PrimaryBlue}"
                                   Margin="0,10,0,0"/>
                            <Frame x:Name="ModalStatusFrame"
                                   BackgroundColor="{StaticResource AccentOrange}"
                                   CornerRadius="15"
                                   Padding="10,5"
                                   HasShadow="False"
                                   HorizontalOptions="Start">
                                <Label x:Name="ModalStatus"
                                       Text="Pending"
                                       TextColor="White"
                                       FontSize="14"
                                       FontAttributes="Bold"/>
                            </Frame>

                            <!-- Resolution Notes (if resolved) -->
                            <StackLayout x:Name="ResolutionNotesContainer"
                                         IsVisible="False"
                                         Spacing="5">
                                <Label Text="Resolution Notes" 
                                       FontSize="16" 
                                       FontAttributes="Bold"
                                       TextColor="{StaticResource PrimaryBlue}"
                                       Margin="0,10,0,0"/>
                                <Label x:Name="ModalResolutionNotes"
                                       FontSize="14"
                                       TextColor="{StaticResource DarkGray}"/>
                                <Label x:Name="ModalResolvedBy"
                                       FontSize="12"
                                       TextColor="{StaticResource DarkGray}"
                                       FontAttributes="Italic"/>
                            </StackLayout>

                        </StackLayout>
                    </StackLayout>
                </ScrollView>
            </Frame>
        </Frame>
    </Grid>
</ContentPage>
